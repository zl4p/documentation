<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Solution pour émulation réseau</title>
    <link rel="stylesheet" href="../src/css/font.css">
    <link rel="stylesheet" href="../src/css/defaut.css">
</head>
<body>
<div class="conteneur">
	<h1 class="title">Solution pour émulation réseau sous LINUX</h1>

<!-- Presentation -->
	<ul>
	<li class="titre1">Présentation</li>
	<li>
		Pour émuler une architecture réseau, il existe plusieurs solutions comme GNS3 ou VIRL de CISCO.<br>
		Dans notre cas, on va chercher à émuler notre architecture avec des routeurs CISCO.<br>
		L'émulation va se faire avec le très connu <b>Dynamips</b>.<br>
		Dynamips est un émulateur de processeur MIPS, à proprement parler il permet d'émuler que les routeurs fonctionnant avec cette famille 
		de processeur. On est donc limiter sur les choix des routeurs qu'il est possible d'émuler, c'est le cas de la famille 7200. C'est ce dernier
		que l'on va utiliser.
	</li>
</ul>

<!-- Installation -->
<ul>
	<li class='titre1'>Installation</li>
	<li>
		Pour notre émulation nous aurons besoin de l'émulation réseau et routeurs.<br>
		Les fichiers nécessaires sont les suivants :<br>
	</li>
	<ul class="listing">
		<li><b>dynamips</b> : <a href="git clone git://github.com/GNS3/dynamips.git">git clone git://github.com/GNS3/dynamips.git</a></li>
		<li><b>dynagen</b> : <a href='https://sourceforge.net/projects/dyna-gen/files/dynagen%20source%20_%20Linux/'>https://sourceforge.net/projects/dyna-gen/files/dynagen%20source%20_%20Linux/</a></li>
	</ul>
	<li class="titre3">Installation Dynamips</li>
	<li>
		Avant d'installer dynamips avec les sources, il est necessaire d'installer le librairies suivantes :
	</li>
	<ul class="listing">
		<li><b>libelf-dev</b> : les fichiers dev pour libelf</li>
		<li><b>libcap0.8-dev</b> : les fichiers dev pour libcap</li>
	</ul>
	<li>Nous pouvons passer à la compilation des sources :</li>
	<li class="coding">
		$ sudo apt install libelf-dev libpcap0.8-dev<br>
		$ git clone git://github.com/GNS3/dynamips.git<br>
		$ cd dynamips<br>
		$ mkdir build<br>
		$ cd build<br>
		$ cmake ..
	</li>
	<li class="titre3">Installation Dynagen</li>
	<li>
		A l'écriture de cet article, la version actuelle est la 0.11.0 .<br>
		Pour fonctionner dynagen, aura besoin de python, assurer qu'une version disponible.
	</li>
	<li class="coding">
		$ <rouge>tar</rouge> xvf dynagen-0.11.0.tar.gz<br>
		$ <rouge>sudo cp</rouge> -pRvf dynagen-0.11.0/ /opt/dynagen/<br>
		$ <rouge>sudo ln</rouge> -sfn /opt/dynagen/dynagen  /usr/bin/dynagen<br>
		$ <rouge>dynagen</rouge> --version
	</li>
</ul>

<!-- IOS Images -->
<ul>
	<li class="titre1">Fichier IOS</li>
	<li>
		Les images IOS ne sont pas libres, il vous faudra le routeur associé pour récupérer une image.<br>
		Ici nous allons utilisé une image de la famille 7200 pour nos routeurs.<br>
	</li>
	<li class="coding">
		$ <rouge>mkdir</rouge> ~/images<br>
		$ <rouge>unzip</rouge> -p images-c7200.bin > c7200.image
	</li>
	<li>
		Notre image est donc disponible.
	</li>
</ul>

<!-- Virtualisation -->
<ul>
	<li class="titre1">Virtualisation</li>
	<li class="titre3">Architecture</li>
	<li>Notre architecture sera la suivante : </li>
	<img src="shema01.drawio.png">
	<li class="titre2">Fichier de configuration</li>
	<li>Le fichier de configuration sera lu par dynagen, et donnera les informations liées à notre architecture précédente,ce qui nous donne :  </li>
	<li class="coding_title">~/virtualisation/network.conf</li>
	<li class="coding">
		<blue>[localhost]</blue><br>
		ghostios = true<br> 
		sparsemem = true<br>
		<rouge>[[7200]]</rouge><br>
		image = ./c7200.image<br>
		model = 7200<br>
		ram = 512<br>
			<rouge>[[ROUTER IPS]]</rouge><br>
			f0/0 = RFS1 f0/0<br>
			f0/1 = RFS2 f0/0<br>
			<rouge>[[ROUTER RFS1]]</rouge><br>
			f0/1 = SWD1 1<br>
			<rouge>[[ROUTER RFS2]]</rouge><br>
			f0/1 = SWD1 1<br>
			<rouge>[[ETHSW SWD1]]</rouge><br>
			1 = access 1<br>
			<rouge>[[ETHSW SWD2]]</rouge><br>
			1 = access 1<br>
	</li>
	<li class="title2">Lancement du réseau</li>
	<li>dynagen est supplié par dynamips pour pouvoir fonctionner, pour virtualiser le fichier image entre autres.</li>
	<li>On va commencer par lancer dynamips sur le port 7200.</li>
	<li class="coding">
		$ dynamips -H 7200 &<br>
		$ dynagen ~/virtualisation/network.conf
	</li>
	<li>Avec la commande list nous verifions que notre configuration a bien été prise en compte :</li>
	<li class="coding">
		Dynagen management console for Dynamips and Pemuwrapper 0.11.0<br>
		Copyright (c) 2005-2007 Greg Anuzelli, contributions Pavel Skovajsa<br>

		=> list<br>
		Name       Type       State      Server          Console<br>
		IPS        7200       running    localhost:7200  2000<br>
		RFS1       7200       running    localhost:7200  2001<br>
		RFS2       7200       running    localhost:7200  2002<br>
		SWD1       ETHSW      always on  localhost:7200  n/a<br>  
		SWD2       ETHSW      always on  localhost:7200  n/a<br>   
		=> 		
	</li>
</ul>

<!-- Connexion-->
<ul>
	<li class="titre1">Connexion</li>
	<li>
		Nous pouvons, nous connectter aux différents équipements. A l'aide de la commande <b>list</b>
		 de dynagen.
	</li>
	<li>
		On peut voir la ligne suivate : <br>
		"<i>IPS        7200       running    <rouge>localhost:7200</rouge>  <blue>2000</blue></i> "<br>
	</li>
	<li class="coding">
		$ <rouge>telnet</rouge> localhost 2000
	</li>


</ul>
</div>
</body>
</html>